---
title: "Statistical Learning in Movies"
author: "Max Sellers, Claire Martino, Ari Augustine, and Rim Nassiri"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# if not installed use: install.packages("package_name")
suppressWarnings(library(dplyr))
suppressWarnings(library(readxl))
suppressWarnings(library(psych))
suppressWarnings(suppressPackageStartupMessages(library(ggplot2)))
```

```{r echo=FALSE}
movies_data= read.csv("MOVIES.csv")
```


### Abstract

To be a producer of film, understanding the factors influencing movie success is extremely important. This project uses statistical learning techniques to predict how successful a film will be critically and popularity-wise. Using a dataset compiled from the Internet Movie Database (IMDB), we delve into the relationships between these variables and movie ratings. Our goal in this project is to use variables like the movie’s budget, revenue, runtime, rating, and popularity we can determine what the film’s critical and commercial success could be by using models like simple and multiple linear regression. 

## I. Introduction

## II. Methods

### a. Cleaning Data
```{r}
movies_data = movies_data %>%
  group_by(title) %>%
  filter(budget >= 1000000 & revenue >= 1000000 & vote_count > 100) %>%
  arrange(desc(vote_average))
```

### b. Choosing Important Values on Dataset
```{r}

#number of categories and variables in the dataset
categories = ncol(movies_data)
var = nrow(movies_data)

#means of variables that will be using in analysis
mean_budget = format(round(mean(movies_data$budget),2),scientific=F)
mean_popularity = format(round(mean(movies_data$popularity),2), scientific = F)
mean_revenue = format(round(mean(movies_data$revenue),2), scientific = F)
mean_vote_average = format(round(mean(movies_data$vote_average),2), scientific = F)
mean_runtime = format(round(mean(movies_data$runtime),2), scientific = F)

```

There are `r categories` categories in this movies dataset that we will be using. 
There are `r var` rows in this dataset that we will be using.  

The mean budget of the dataset is `r mean_budget`.
The mean popularity of the movies is `r mean_popularity`.
The mean revenue of the movies is `r mean_revenue`.
The mean voter average of the movies `r mean_vote_average`.
The mean runtime of the movies is `r mean_runtime`. 


### c. Training/Testing Data [USE SOMEWHERE]
```{r}

num_obs = nrow(movies_data)  #extracting the total rows from the data set

movies_indx = sample(num_obs, size = trunc(0.6*num_obs))

#training data set:
movies_train = movies_data[movies_indx,]

#test data set:
movies_test = movies_data[-movies_indx,]
```


## III. Results

### a. Linear Regression Summary and Line
```{r}
#linear regression model of budget vs vote_average
linear_1 = lm(budget ~ vote_average, data = movies_data)
summary_linear1 = summary(linear_1)

r_2_lin_1 = summary_linear1$r.squared


#graph of above data
plot(budget~ vote_average, data= movies_data, xlab = "Voter Average", ylab = "Budget", main = "Scatterplot of Budget vs Voter Average")
abline(linear_1, col = "red")
```

Since the Pr(>|t|) value of voter average is 8.77e_07, and this value is less than the standard level of significance of 0.05, this shows that there is a statistically significant relationship between voter average and budget.

In order to assess the relationship between the predictor and the response variable, you must look at the $R^2$ value. In this case, $R^2$ = `r r_2_lin_1`. Since this value is closer to 0 than it is 1, this indicates a weak relationship between voter average and budget.

This scatterplot with the linear regression line shows a weak and negative relationship between between budget and voter average.



```{r}
#linear regression model of revenue vs popularity
linear_2 = lm(revenue ~ popularity, data = movies_data)
summary_linear2 = summary(linear_2)

r_2_lin_2 = summary_linear2$r.squared


plot(revenue ~ popularity, data= movies_data, xlab = "Popularity", ylab = "Revenue", main = "Scatterplot of Revenue vs Popularity")
abline(linear_2, col = "purple")

```

Since the Pr(>|t|) value of popularity is <2e-16, and this value is less than the standard level of significance of 0.05, this shows that there is a statistically significant relationship between popularity and revenue.

In order to assess the relationship between the predictor and the response variable, you must look at the $R^2$ value. In this case, $R^2$ = `r r_2_lin_2`. Since this value is closer to 0 than it is 1, this indicates a mildly weak relationship between revenue and popularity.

The scatter plot with the linear regression line shows this mildy weak positive relationship between revenue and popularity. 



```{r}
linear_3 = lm(vote_average ~ budget, data = movies_data)
summary_linear3 = summary(linear_3)

r_2_lin_3 = summary_linear3$r.squared

plot(vote_average ~ budget, data= movies_data, xlab = "Popularity", ylab = "Revenue", main = "Scatterplot of Revenue vs Popularity")
abline(linear_3, col = "purple")
```

Since the Pr(>|t|) value of popularity is 8.77e-07, and this value is less than the standard level of significance of 0.05, this shows that there is a statistically significant relationship between popularity and revenue.

In order to assess the relationship between the predictor and the response variable, you must look at the $R^2$ value. In this case, $R^2$ = `r r_2_lin_3`. Since this value is closer to 0 than it is 1, this indicates a weak relationship between revenue and popularity.

The scatter plot with the linear regression line shows this weak negative relationship between revenue and popularity.


### b. Trained Simple Linear Regression Summary
```{r}
y.trn = movies_train$revenue
x.trn = movies_train$budget

train.data_frame = data.frame(y.trn, x.trn)

model_train = glm(formula = y.trn ~ x.trn, data = train.data_frame)
summary(model_train)

plot(model_train)

actual = movies_test$revenue
predicted = ifelse(predict(model_train) > 0, "Yes", "No")

error_function = function(actual, predicted){
  mean(actual != predicted)
}

1- error_function(actual = actual, predicted = predicted)

library(caret)
train_table = table(Prediced = predicted, Actual = y.trn)

train_confusion_matrix = confusionMatrix(train_table, positive = "Yes")

train_confusion_matrix
 
```


## IV. Discussion


